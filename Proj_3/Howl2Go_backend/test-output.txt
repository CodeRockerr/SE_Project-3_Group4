
> food-delivery-backend@1.0.0 test
> node --experimental-vm-modules ./node_modules/jest/bin/jest.js --runInBand --coverage

Global test setup complete - test environment configured
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ”‘ add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running tests against database: test

      at Object.log (src/__tests__/user.test.js:30:13)

  console.error
    Failed to create Stripe customer: Error: Stripe is not configured. Please set STRIPE_SECRET_KEY in environment variables.
        at ensureStripeCustomerForUser (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:28:11)
        at ensureStripeCustomerForUser (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/user.controller.js:45:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      45 |       await ensureStripeCustomerForUser(user._id);
      46 |     } catch (stripeError) {
    > 47 |       console.error("Failed to create Stripe customer:", stripeError);
         |               ^
      48 |       // Don't block signup if Stripe customer creation fails
      49 |     }
      50 |

      at error (src/controllers/user.controller.js:47:15)

[0mPOST /api/users/register [32m201[0m 244.077 ms - 918[0m
[0mPOST /api/users/register [33m409[0m 2.435 ms - 65[0m
[0mPOST /api/users/register [33m400[0m 0.614 ms - 70[0m
  console.error
    Registration error: Error: User validation failed: email: Please provide a valid email address
        at ValidationError.inspect (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/error/validation.js:52:26)
        at formatValue (node:internal/util/inspect:897:19)
        at inspect (node:internal/util/inspect:409:10)
        at formatWithOptionsInternal (node:internal/util/inspect:2592:40)
        at format (node:internal/util/inspect:2449:10)
        at console.error (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/@jest/console/build/index.js:288:48)
        at error (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/user.controller.js:75:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5) {
      errors: {
        email: ValidatorError: Please provide a valid email address
            at validate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1417:13)
            at SchemaString.SchemaType.doValidate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1401:7)
            at /Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/document.js:3115:18
            at processTicksAndRejections (node:internal/process/task_queues:85:11) {
          properties: [Object],
          kind: 'regexp',
          path: 'email',
          value: 'invalid-email',
          reason: undefined,
          Symbol(mongoose#validatorError): true
        }
      },
      _message: 'User validation failed'
    }

      73 |     });
      74 |   } catch (error) {
    > 75 |     console.error("Registration error:", error);
         |             ^
      76 |
      77 |     // Handle validation errors
      78 |     if (error.name === "ValidationError") {

      at error (src/controllers/user.controller.js:75:13)

[0mPOST /api/users/register [33m400[0m 4.335 ms - 97[0m
  console.error
    Registration error: Error: User validation failed: password: Password must be at least 8 characters long
        at ValidationError.inspect (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/error/validation.js:52:26)
        at formatValue (node:internal/util/inspect:897:19)
        at inspect (node:internal/util/inspect:409:10)
        at formatWithOptionsInternal (node:internal/util/inspect:2592:40)
        at format (node:internal/util/inspect:2449:10)
        at console.error (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/@jest/console/build/index.js:288:48)
        at error (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/user.controller.js:75:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5) {
      errors: {
        password: ValidatorError: Password must be at least 8 characters long
            at validate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1417:13)
            at SchemaString.SchemaType.doValidate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1401:7)
            at /Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/document.js:3115:18
            at processTicksAndRejections (node:internal/process/task_queues:85:11) {
          properties: [Object],
          kind: 'minlength',
          path: 'password',
          value: 'Pass1!',
          reason: undefined,
          Symbol(mongoose#validatorError): true
        }
      },
      _message: 'User validation failed'
    }

      73 |     });
      74 |   } catch (error) {
    > 75 |     console.error("Registration error:", error);
         |             ^
      76 |
      77 |     // Handle validation errors
      78 |     if (error.name === "ValidationError") {

      at error (src/controllers/user.controller.js:75:13)

[0mPOST /api/users/register [33m400[0m 2.826 ms - 104[0m
[0mPOST /api/users/login [32m200[0m 220.656 ms - 906[0m
[0mPOST /api/users/login [33m401[0m 213.377 ms - 55[0m
[0mPOST /api/users/login [33m401[0m 2.004 ms - 55[0m
[0mPOST /api/users/login [33m400[0m 0.353 ms - 63[0m
[0mGET /api/users/profile [32m200[0m 4.547 ms - 410[0m
[0mGET /api/users/profile [33m401[0m 0.395 ms - 53[0m
[0mGET /api/users/profile [33m401[0m 0.534 ms - 43[0m
[0mPOST /api/users/change-password [32m200[0m 440.424 ms - 628[0m
[0mPOST /api/users/change-password [33m401[0m 216.496 ms - 59[0m
[0mPOST /api/users/login [32m200[0m 246.200 ms - 906[0m
[0mPOST /api/users/login [32m200[0m 216.500 ms - 906[0m
[0mPOST /api/users/refresh-token [32m200[0m 1.842 ms - 362[0m
[0mPOST /api/users/refresh-token [33m401[0m 0.419 ms - 43[0m
[0mPOST /api/users/refresh-token [33m400[0m 0.290 ms - 55[0m
[0mPOST /api/users/change-password [33m400[0m 1.941 ms - 78[0m
  console.error
    Change password error: Error: User validation failed: password: Password must be at least 8 characters long
        at ValidationError.inspect (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/error/validation.js:52:26)
        at formatValue (node:internal/util/inspect:897:19)
        at inspect (node:internal/util/inspect:409:10)
        at formatWithOptionsInternal (node:internal/util/inspect:2592:40)
        at format (node:internal/util/inspect:2449:10)
        at console.error (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/@jest/console/build/index.js:288:48)
        at error (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/user.controller.js:278:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5) {
      errors: {
        password: ValidatorError: Password must be at least 8 characters long
            at validate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1417:13)
            at SchemaString.SchemaType.doValidate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1401:7)
            at /Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/document.js:3115:18
            at processTicksAndRejections (node:internal/process/task_queues:85:11) {
          properties: [Object],
          kind: 'minlength',
          path: 'password',
          value: 'weak',
          reason: undefined,
          Symbol(mongoose#validatorError): true
        }
      },
      _message: 'User validation failed'
    }

      276 |     });
      277 |   } catch (error) {
    > 278 |     console.error("Change password error:", error);
          |             ^
      279 |
      280 |     if (error.name === "ValidationError") {
      281 |       const errors = Object.values(error.errors).map((err) => err.message);

      at error (src/controllers/user.controller.js:278:13)

[0mPOST /api/users/change-password [33m400[0m 298.830 ms - 104[0m
[0mGET /api/users/profile [33m401[0m 2.141 ms - 51[0m
  console.error
    Failed to create Stripe customer: Error: Stripe is not configured. Please set STRIPE_SECRET_KEY in environment variables.
        at ensureStripeCustomerForUser (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:28:11)
        at ensureStripeCustomerForUser (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/user.controller.js:45:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      45 |       await ensureStripeCustomerForUser(user._id);
      46 |     } catch (stripeError) {
    > 47 |       console.error("Failed to create Stripe customer:", stripeError);
         |               ^
      48 |       // Don't block signup if Stripe customer creation fails
      49 |     }
      50 |

      at error (src/controllers/user.controller.js:47:15)

[0mPOST /api/users/register [32m201[0m 236.599 ms - 932[0m
[0mPOST /api/users/register [33m409[0m 1.624 ms - 65[0m
[0mPOST /api/users/login [32m200[0m 217.190 ms - 906[0m
[0mPOST /api/users/change-password [33m401[0m 1.651 ms - 51[0m
[0mPOST /api/users/refresh-token [33m401[0m 0.508 ms - 43[0m
[0mPOST /api/users/login [33m401[0m 213.805 ms - 77[0m
[0mPOST /api/users/refresh-token [33m401[0m 2.032 ms - 67[0m
  console.error
    Registration error: Error: User validation failed: password: Password must be at least 8 characters long
        at ValidationError.inspect (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/error/validation.js:52:26)
        at formatValue (node:internal/util/inspect:897:19)
        at inspect (node:internal/util/inspect:409:10)
        at formatWithOptionsInternal (node:internal/util/inspect:2592:40)
        at format (node:internal/util/inspect:2449:10)
        at console.error (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/@jest/console/build/index.js:288:48)
        at error (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/user.controller.js:75:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5) {
      errors: {
        password: ValidatorError: Password must be at least 8 characters long
            at validate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1417:13)
            at SchemaString.SchemaType.doValidate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1401:7)
            at /Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/document.js:3115:18
            at processTicksAndRejections (node:internal/process/task_queues:85:11) {
          properties: [Object],
          kind: 'minlength',
          path: 'password',
          value: 'short',
          reason: undefined,
          Symbol(mongoose#validatorError): true
        }
      },
      _message: 'User validation failed'
    }

      73 |     });
      74 |   } catch (error) {
    > 75 |     console.error("Registration error:", error);
         |             ^
      76 |
      77 |     // Handle validation errors
      78 |     if (error.name === "ValidationError") {

      at error (src/controllers/user.controller.js:75:13)

[0mPOST /api/users/register [33m400[0m 3.122 ms - 104[0m
  console.error
    Change password error: Error: User validation failed: password: Password must be at least 8 characters long
        at ValidationError.inspect (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/error/validation.js:52:26)
        at formatValue (node:internal/util/inspect:897:19)
        at inspect (node:internal/util/inspect:409:10)
        at formatWithOptionsInternal (node:internal/util/inspect:2592:40)
        at format (node:internal/util/inspect:2449:10)
        at console.error (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/@jest/console/build/index.js:288:48)
        at error (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/user.controller.js:278:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5) {
      errors: {
        password: ValidatorError: Password must be at least 8 characters long
            at validate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1417:13)
            at SchemaString.SchemaType.doValidate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1401:7)
            at /Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/document.js:3115:18
            at processTicksAndRejections (node:internal/process/task_queues:85:11) {
          properties: [Object],
          kind: 'minlength',
          path: 'password',
          value: 'bad',
          reason: undefined,
          Symbol(mongoose#validatorError): true
        }
      },
      _message: 'User validation failed'
    }

      276 |     });
      277 |   } catch (error) {
    > 278 |     console.error("Change password error:", error);
          |             ^
      279 |
      280 |     if (error.name === "ValidationError") {
      281 |       const errors = Object.values(error.errors).map((err) => err.message);

      at error (src/controllers/user.controller.js:278:13)

[0mPOST /api/users/change-password [33m400[0m 219.492 ms - 104[0m
[0mGET /api/users/profile [32m200[0m 3.528 ms - 410[0m
[0mPOST /api/users/register [33m409[0m 1.757 ms - 65[0m
[0mPOST /api/users/login [32m200[0m 218.441 ms - 906[0m
[0mPOST /api/users/login [32m200[0m 216.750 ms - 906[0m
[0mPOST /api/users/change-password [32m200[0m 431.540 ms - 628[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ” prevent committing .env to code: https://dotenvx.com/precommit

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running tests against database: test

      at Object.log (src/__tests__/cart.test.js:28:17)

[0mGET /api/cart [32m200[0m 24.014 ms - 125[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'YJRHoZ78rkYYIOEUnPcCFZ6kvMSvD_0S',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baeb69'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'YJRHoZ78rkYYIOEUnPcCFZ6kvMSvD_0S',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baeb69'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 31.174 ms - 407[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'CIkifya3lOAIvp3bx1z6jndHd3gS1Jc7',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baeb72'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'CIkifya3lOAIvp3bx1z6jndHd3gS1Jc7',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baeb72'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 13.846 ms - 405[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'CIkifya3lOAIvp3bx1z6jndHd3gS1Jc7',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baeb72'), itemsBefore: 1 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'CIkifya3lOAIvp3bx1z6jndHd3gS1Jc7',
      totalItems: 3,
      totalPrice: 15,
      totalCalories: 1500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baeb72'),
      totalItems: 3,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 14.156 ms - 407[0m
[0mPOST /api/cart/items [33m400[0m 0.460 ms - 54[0m
[0mPOST /api/cart/items [33m404[0m 1.617 ms - 49[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'MVBxpDWMLHJcViM59clBt-Jo0vLR7Fqq',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baeb85'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'MVBxpDWMLHJcViM59clBt-Jo0vLR7Fqq',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baeb85'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.467 ms - 405[0m
  console.log
    [Cart] updateItemQuantity saved cart totals: {
      sessionId: 'MVBxpDWMLHJcViM59clBt-Jo0vLR7Fqq',
      totalItems: 5,
      totalPrice: 25,
      itemsCount: 1
    }

      at log (src/models/Cart.js:160:17)

[0mPATCH /api/cart/items/6937042278d5637440baeb43 [32m200[0m 7.473 ms - 380[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'x6exS-k_q40aKUB756Yoq_Pjhg3fG7WW',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baeb92'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'x6exS-k_q40aKUB756Yoq_Pjhg3fG7WW',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baeb92'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 13.242 ms - 407[0m
  console.log
    [Cart] removeItem saved cart totals: {
      sessionId: 'x6exS-k_q40aKUB756Yoq_Pjhg3fG7WW',
      totalItems: 0,
      totalPrice: 0,
      itemsCount: 0
    }

      at log (src/models/Cart.js:135:15)

[0mPATCH /api/cart/items/6937042278d5637440baeb43 [32m200[0m 4.714 ms - 142[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '2XDTrriLKKq6gxvZMMUBERpd-cHL9Hxe',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 3
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baeb9e'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '2XDTrriLKKq6gxvZMMUBERpd-cHL9Hxe',
      totalItems: 3,
      totalPrice: 15,
      totalCalories: 1500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baeb9e'),
      totalItems: 3,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.792 ms - 407[0m
  console.log
    [Cart] removeItem saved cart totals: {
      sessionId: '2XDTrriLKKq6gxvZMMUBERpd-cHL9Hxe',
      totalItems: 0,
      totalPrice: 0,
      itemsCount: 0
    }

      at log (src/models/Cart.js:135:15)

[0mDELETE /api/cart/items/6937042278d5637440baeb43 [32m200[0m 4.586 ms - 142[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'DqoiiIAn5YPwnh1aSutWfl_4HAkPLoDj',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 5
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baebaa'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'DqoiiIAn5YPwnh1aSutWfl_4HAkPLoDj',
      totalItems: 5,
      totalPrice: 25,
      totalCalories: 2500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baebaa'),
      totalItems: 5,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.898 ms - 407[0m
[0mDELETE /api/cart [32m200[0m 3.604 ms - 132[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'R8tzTnXomndf6DdCYDYhewrXKgXVHKqU',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baebb5'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'R8tzTnXomndf6DdCYDYhewrXKgXVHKqU',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baebb5'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.885 ms - 407[0m
[0mGET /api/cart [32m200[0m 5.371 ms - 376[0m
[0mPOST /api/cart/items [33m400[0m 0.380 ms - 50[0m
[0mPOST /api/cart/items [33m400[0m 0.400 ms - 50[0m
[0mPOST /api/cart/items [33m400[0m 0.345 ms - 56[0m
[0mPOST /api/cart/items [33m400[0m 0.322 ms - 56[0m
[0mPATCH /api/cart/items/invalid-id [33m404[0m 1.500 ms - 44[0m
[0mPATCH /api/cart/items/6937042278d5637440baebc1 [33m404[0m 1.345 ms - 44[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '4fbNBA9R5AnZv2rVFAc8EB6Z7IaVcdyd',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baebc5'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '4fbNBA9R5AnZv2rVFAc8EB6Z7IaVcdyd',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baebc5'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.484 ms - 407[0m
[0mPATCH /api/cart/items/6937042278d5637440baeb43 [33m400[0m 0.473 ms - 56[0m
[0mDELETE /api/cart/items/invalid-id [33m404[0m 1.555 ms - 44[0m
[0mDELETE /api/cart/items/6937042278d5637440baebcd [33m404[0m 1.281 ms - 44[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'tnNvjUGNKj7hoK0b77tTXdhC8d-0sSdK',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baebd1'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'tnNvjUGNKj7hoK0b77tTXdhC8d-0sSdK',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baebd1'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.012 ms - 407[0m
[0mGET /api/cart [32m200[0m 5.243 ms - 376[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'udBsQoiW9EvzaOf40M5UDr8Bh9FUpwQw',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baebde'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'udBsQoiW9EvzaOf40M5UDr8Bh9FUpwQw',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baebde'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.985 ms - 407[0m
[0mGET /api/cart [32m200[0m 5.355 ms - 376[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '-Bk5FlC9hvQL_8_D9YGWe3L3vrD3iWWT',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baebeb'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '-Bk5FlC9hvQL_8_D9YGWe3L3vrD3iWWT',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baebeb'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.639 ms - 405[0m
[0mGET /api/cart [32m200[0m 5.145 ms - 374[0m
  console.log
    [Cart] updateItemQuantity saved cart totals: {
      sessionId: '-Bk5FlC9hvQL_8_D9YGWe3L3vrD3iWWT',
      totalItems: 3,
      totalPrice: 15,
      itemsCount: 1
    }

      at log (src/models/Cart.js:160:17)

[0mPATCH /api/cart/items/6937042278d5637440baeb43 [32m200[0m 7.626 ms - 380[0m
[0mGET /api/cart [32m200[0m 5.247 ms - 376[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'j7nmD2ghUSk-4ageivosHdtjUwChifhQ',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec02'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'j7nmD2ghUSk-4ageivosHdtjUwChifhQ',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec02'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.624 ms - 407[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'j7nmD2ghUSk-4ageivosHdtjUwChifhQ',
      userId: null,
      foodItemId: '6937042278d5637440baebfe',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec02'), itemsBefore: 1 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'j7nmD2ghUSk-4ageivosHdtjUwChifhQ',
      totalItems: 3,
      totalPrice: 13,
      totalCalories: 1300,
      itemsCount: 2
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec02'),
      totalItems: 3,
      items: 2
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 14.675 ms - 652[0m
[0mGET /api/cart [32m200[0m 5.391 ms - 621[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '3Q1KdFaLv1hbIZEpcZNjkbWbNKvte7lS',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec17'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '3Q1KdFaLv1hbIZEpcZNjkbWbNKvte7lS',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec17'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.706 ms - 407[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '3Q1KdFaLv1hbIZEpcZNjkbWbNKvte7lS',
      userId: null,
      foodItemId: '6937042278d5637440baebfe',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec17'), itemsBefore: 1 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '3Q1KdFaLv1hbIZEpcZNjkbWbNKvte7lS',
      totalItems: 3,
      totalPrice: 13,
      totalCalories: 1300,
      itemsCount: 2
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec17'),
      totalItems: 3,
      items: 2
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 14.125 ms - 652[0m
  console.log
    [Cart] removeItem saved cart totals: {
      sessionId: '3Q1KdFaLv1hbIZEpcZNjkbWbNKvte7lS',
      totalItems: 1,
      totalPrice: 3,
      itemsCount: 1
    }

      at log (src/models/Cart.js:135:15)

[0mDELETE /api/cart/items/6937042278d5637440baeb43 [32m200[0m 6.997 ms - 386[0m
[0mGET /api/cart [32m200[0m 5.035 ms - 371[0m
[0mPOST /api/cart/merge [33m401[0m 0.501 ms - 53[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'RiaOfdwdq6uwhEyRtbVBZRmG4JlfoIh0',
      userId: null,
      foodItemId: '6937042278d5637440baec2e',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec32'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'RiaOfdwdq6uwhEyRtbVBZRmG4JlfoIh0',
      totalItems: 1,
      totalPrice: 2,
      totalCalories: 0,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec32'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.791 ms - 407[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '6Me0hVeXzMx3KsAmL2l0ij1U9IZyGofu',
      userId: null,
      foodItemId: '6937042278d5637440baec3a',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec3e'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '6Me0hVeXzMx3KsAmL2l0ij1U9IZyGofu',
      totalItems: 1,
      totalPrice: 2.5,
      totalCalories: 250,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec3e'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.761 ms - 409[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '88lo--d4hL7U4RzNJ_cvTujVjb0Xi4Lf',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 999999
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec48'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '88lo--d4hL7U4RzNJ_cvTujVjb0Xi4Lf',
      totalItems: 999999,
      totalPrice: 4999995,
      totalCalories: 499999500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec48'),
      totalItems: 999999,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.909 ms - 427[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'YUWi270tgyMMgkpVqaZIhGNYwihmB7T_',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: '5'
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec51'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'YUWi270tgyMMgkpVqaZIhGNYwihmB7T_',
      totalItems: 5,
      totalPrice: 25,
      totalCalories: 2500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec51'),
      totalItems: 5,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.615 ms - 407[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'GxBt_0NDFf7sq5SqGtfRa6x65Tr0i6l-',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 3.7
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec5a'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'GxBt_0NDFf7sq5SqGtfRa6x65Tr0i6l-',
      totalItems: 3,
      totalPrice: 15,
      totalCalories: 1500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec5a'),
      totalItems: 3,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.542 ms - 407[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'dV4vHUuEJhUs7oicQZgZjfGZF95MsQzK',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec63'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'dV4vHUuEJhUs7oicQZgZjfGZF95MsQzK',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec63'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.565 ms - 405[0m
[0mGET /api/cart [32m200[0m 3.803 ms - 125[0m
[0mPOST /api/cart/items [33m400[0m 0.352 ms - 50[0m
[0mPOST /api/cart/items [33m400[0m 0.362 ms - 50[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'd4W-RoQzSHI7L5W0gICRS6DT8AwhyIpk',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec73'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'd4W-RoQzSHI7L5W0gICRS6DT8AwhyIpk',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec73'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.395 ms - 405[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'GXiDXVdQQ336QYe50Dw8A0KYG4ttUx3o',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec7c'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'GXiDXVdQQ336QYe50Dw8A0KYG4ttUx3o',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec7c'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.113 ms - 407[0m
[0mGET /api/cart [32m200[0m 4.754 ms - 376[0m
  console.log
    [Cart] updateItemQuantity saved cart totals: {
      sessionId: 'GXiDXVdQQ336QYe50Dw8A0KYG4ttUx3o',
      totalItems: 5,
      totalPrice: 25,
      itemsCount: 1
    }

      at log (src/models/Cart.js:160:17)

[0mPATCH /api/cart/items/6937042278d5637440baeb43 [32m200[0m 6.414 ms - 380[0m
[0mGET /api/cart [32m200[0m 4.922 ms - 376[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'ekxbVglL8TuG0-WYh6MbxeWp8y3w_kSv',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec91'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'ekxbVglL8TuG0-WYh6MbxeWp8y3w_kSv',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec91'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.085 ms - 405[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'ekxbVglL8TuG0-WYh6MbxeWp8y3w_kSv',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec91'), itemsBefore: 1 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'ekxbVglL8TuG0-WYh6MbxeWp8y3w_kSv',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec91'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.179 ms - 407[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'ekxbVglL8TuG0-WYh6MbxeWp8y3w_kSv',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baec91'), itemsBefore: 1 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'ekxbVglL8TuG0-WYh6MbxeWp8y3w_kSv',
      totalItems: 3,
      totalPrice: 15,
      totalCalories: 1500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baec91'),
      totalItems: 3,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.312 ms - 407[0m
[0mGET /api/cart [32m200[0m 5.146 ms - 376[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'ms7sYj1rXMW_1Dtyoq-qPNnx0tOqsRg6',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baecae'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'ms7sYj1rXMW_1Dtyoq-qPNnx0tOqsRg6',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baecae'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 13.293 ms - 405[0m
  console.log
    [Cart] updateItemQuantity saved cart totals: {
      sessionId: 'ms7sYj1rXMW_1Dtyoq-qPNnx0tOqsRg6',
      totalItems: 2,
      totalPrice: 10,
      itemsCount: 1
    }

      at log (src/models/Cart.js:160:17)

[0mPATCH /api/cart/items/6937042278d5637440baeb43 [32m200[0m 6.341 ms - 380[0m
  console.log
    [Cart] updateItemQuantity saved cart totals: {
      sessionId: 'ms7sYj1rXMW_1Dtyoq-qPNnx0tOqsRg6',
      totalItems: 5,
      totalPrice: 25,
      itemsCount: 1
    }

      at log (src/models/Cart.js:160:17)

[0mPATCH /api/cart/items/6937042278d5637440baeb43 [32m200[0m 7.124 ms - 380[0m
  console.log
    [Cart] updateItemQuantity saved cart totals: {
      sessionId: 'ms7sYj1rXMW_1Dtyoq-qPNnx0tOqsRg6',
      totalItems: 3,
      totalPrice: 15,
      itemsCount: 1
    }

      at log (src/models/Cart.js:160:17)

[0mPATCH /api/cart/items/6937042278d5637440baeb43 [32m200[0m 6.132 ms - 380[0m
[0mGET /api/cart [32m200[0m 4.999 ms - 376[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'nPOmHtQiz0GY7SKTPDqXZKQ3-A7dzCci',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baecc7'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'nPOmHtQiz0GY7SKTPDqXZKQ3-A7dzCci',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baecc7'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.712 ms - 405[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'QyB5j_7iZaQWTLVA42uuqzPdHgmYRgx1',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 3
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baecd0'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'QyB5j_7iZaQWTLVA42uuqzPdHgmYRgx1',
      totalItems: 3,
      totalPrice: 15,
      totalCalories: 1500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baecd0'),
      totalItems: 3,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 13.296 ms - 407[0m
[0mGET /api/cart [32m200[0m 3.843 ms - 125[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '0iKncQraRvuRACRzg7RpeDg031dRG6l9',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baecdd'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '0iKncQraRvuRACRzg7RpeDg031dRG6l9',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baecdd'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.590 ms - 405[0m
[0mGET /api/cart [32m200[0m 5.255 ms - 125[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'A7Sz7MlPUgCv64ZNbjysSXSuC728gMP3',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baecea'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'A7Sz7MlPUgCv64ZNbjysSXSuC728gMP3',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baecea'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.724 ms - 405[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'TOB1fQFZSG3bQU518tQMubPC47urE_rU',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baecf3'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'TOB1fQFZSG3bQU518tQMubPC47urE_rU',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baecf3'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.193 ms - 405[0m
  console.log
    [Cart] updateItemQuantity saved cart totals: {
      sessionId: 'TOB1fQFZSG3bQU518tQMubPC47urE_rU',
      totalItems: 3,
      totalPrice: 15,
      itemsCount: 1
    }

      at log (src/models/Cart.js:160:17)

[0mPATCH /api/cart/items/6937042278d5637440baeb43 [32m200[0m 7.553 ms - 380[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'DN6M0rpSycT2-3U62JCy_JcZMz-eopJe',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baed00'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'DN6M0rpSycT2-3U62JCy_JcZMz-eopJe',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baed00'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.455 ms - 405[0m
  console.log
    [Cart] removeItem saved cart totals: {
      sessionId: 'DN6M0rpSycT2-3U62JCy_JcZMz-eopJe',
      totalItems: 0,
      totalPrice: 0,
      itemsCount: 0
    }

      at log (src/models/Cart.js:135:15)

[0mDELETE /api/cart/items/6937042278d5637440baeb43 [32m200[0m 4.022 ms - 142[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'Sw8ruHqL1VAn4Yrx_xdu7ipqt4fF1wVq',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042278d5637440baed0c'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'Sw8ruHqL1VAn4Yrx_xdu7ipqt4fF1wVq',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042278d5637440baed0c'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.353 ms - 405[0m
[0mDELETE /api/cart [32m200[0m 3.125 ms - 132[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '3bKHfm5c9Nomk_suw4dkBP6BG7lr9cIF',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042378d5637440baed17'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '3bKHfm5c9Nomk_suw4dkBP6BG7lr9cIF',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042378d5637440baed17'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.516 ms - 407[0m
  console.log
    [Cart] removeItem saved cart totals: {
      sessionId: '3bKHfm5c9Nomk_suw4dkBP6BG7lr9cIF',
      totalItems: 0,
      totalPrice: 0,
      itemsCount: 0
    }

      at log (src/models/Cart.js:135:15)

[0mPATCH /api/cart/items/6937042278d5637440baeb43 [32m200[0m 4.276 ms - 142[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'epNt5awLdBrs0w3_qiAMC4F-rXq39Cd-',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042378d5637440baed23'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'epNt5awLdBrs0w3_qiAMC4F-rXq39Cd-',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042378d5637440baed23'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.087 ms - 405[0m
  console.log
    [Cart] updateItemQuantity saved cart totals: {
      sessionId: 'epNt5awLdBrs0w3_qiAMC4F-rXq39Cd-',
      totalItems: 5,
      totalPrice: 25,
      itemsCount: 1
    }

      at log (src/models/Cart.js:160:17)

[0mPATCH /api/cart/items/6937042278d5637440baeb43 [32m200[0m 6.731 ms - 380[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'mQOzALlcD2grtao6GSR_Pa_bkcCUBp6_',
      userId: null,
      foodItemId: '6937042378d5637440baed2e',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042378d5637440baed32'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'mQOzALlcD2grtao6GSR_Pa_bkcCUBp6_',
      totalItems: 1,
      totalPrice: 2,
      totalCalories: 0,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042378d5637440baed32'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.427 ms - 400[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'ST4eEJV9WE3iP7YbZWHTnGbtz0dKcJtK',
      userId: null,
      foodItemId: '6937042378d5637440baed3a',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042378d5637440baed3e'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'ST4eEJV9WE3iP7YbZWHTnGbtz0dKcJtK',
      totalItems: 1,
      totalPrice: 2,
      totalCalories: 0,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042378d5637440baed3e'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.206 ms - 405[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'Dhp0ZO48HMgSBU8Ohd5dEFupP4fRIIrI',
      userId: null,
      foodItemId: '6937042378d5637440baed46',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042378d5637440baed4a'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'Dhp0ZO48HMgSBU8Ohd5dEFupP4fRIIrI',
      totalItems: 1,
      totalPrice: 15,
      totalCalories: 2000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042378d5637440baed4a'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.170 ms - 423[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '6sYIK7OlyEUysU2IPcUvaaNTwHQiMNLK',
      userId: null,
      foodItemId: '6937042378d5637440baed52',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042378d5637440baed56'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '6sYIK7OlyEUysU2IPcUvaaNTwHQiMNLK',
      totalItems: 1,
      totalPrice: 2,
      totalCalories: 50,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042378d5637440baed56'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.280 ms - 410[0m
[0mPOST /api/cart/merge [32m200[0m 7.606 ms - 144[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'wRpDQ9SOZjDEJwhg42gUrXp7rQorzf4S',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 2
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042378d5637440baed6e'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'wRpDQ9SOZjDEJwhg42gUrXp7rQorzf4S',
      totalItems: 2,
      totalPrice: 10,
      totalCalories: 1000,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042378d5637440baed6e'),
      totalItems: 2,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.317 ms - 407[0m
  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'different-session-id',
      totalItems: 3,
      totalPrice: 15,
      totalCalories: 1500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

[0mPOST /api/cart/merge [32m200[0m 10.985 ms - 392[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'UInJJ19NB2g9KPk9eUS_99Ina-NeGa6U',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042378d5637440baed80'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'UInJJ19NB2g9KPk9eUS_99Ina-NeGa6U',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042378d5637440baed80'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.668 ms - 405[0m
[0mGET /api/cart [32m200[0m 9.084 ms - 410[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'wvj-sHsDhpPqII9FW85OY38jY-eclAqT',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 3
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042378d5637440baed93'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'wvj-sHsDhpPqII9FW85OY38jY-eclAqT',
      totalItems: 3,
      totalPrice: 15,
      totalCalories: 1500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042378d5637440baed93'),
      totalItems: 3,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.390 ms - 407[0m
[0mPOST /api/cart/merge [32m200[0m 8.699 ms - 392[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'shl4DHA4YissYXCRAELjsQGtnRGOHmNR',
      userId: null,
      foodItemId: '6937042478d5637440baeda4',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042478d5637440baeda8'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'shl4DHA4YissYXCRAELjsQGtnRGOHmNR',
      totalItems: 1,
      totalPrice: 2,
      totalCalories: -100,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042478d5637440baeda8'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 12.290 ms - 419[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: 'vP-WeEVl6hUhpYoSNqlO85gGxYnCJXOP',
      userId: null,
      foodItemId: '6937042278d5637440baeb43',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042478d5637440baedb2'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: 'vP-WeEVl6hUhpYoSNqlO85gGxYnCJXOP',
      totalItems: 1,
      totalPrice: 5,
      totalCalories: 500,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042478d5637440baedb2'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.078 ms - 405[0m
[0mGET /api/cart [32m200[0m 4.680 ms - 374[0m
  console.log
    [CartController] addItemToCart called {
      sessionId: '5cwF1MXnCJ8pCB4ZBwsPPpj54kPoBQJZ',
      userId: null,
      foodItemId: '6937042478d5637440baedbd',
      quantity: 1
    }

      at log (src/controllers/cart.controller.js:155:13)

  console.log
    [CartController] got cart { cartId: new ObjectId('6937042478d5637440baedc1'), itemsBefore: 0 }

      at log (src/controllers/cart.controller.js:162:13)

  console.log
    [Cart] addItem saved cart totals: {
      sessionId: '5cwF1MXnCJ8pCB4ZBwsPPpj54kPoBQJZ',
      totalItems: 1,
      totalPrice: 4.5,
      totalCalories: 450,
      itemsCount: 1
    }

      at log (src/models/Cart.js:113:15)

  console.log
    [CartController] updated cart after addItem {
      id: new ObjectId('6937042478d5637440baedc1'),
      totalItems: 1,
      items: 1
    }

      at log (src/controllers/cart.controller.js:186:13)

[0mPOST /api/cart/items [32m200[0m 11.849 ms - 425[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ› ï¸  run anywhere with `dotenvx run -- yourcommand`

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.error
    Failed to create Stripe customer: Error: Stripe is not configured. Please set STRIPE_SECRET_KEY in environment variables.
        at ensureStripeCustomerForUser (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:28:11)
        at ensureStripeCustomerForUser (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/user.controller.js:45:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      45 |       await ensureStripeCustomerForUser(user._id);
      46 |     } catch (stripeError) {
    > 47 |       console.error("Failed to create Stripe customer:", stripeError);
         |               ^
      48 |       // Don't block signup if Stripe customer creation fails
      49 |     }
      50 |

      at error (src/controllers/user.controller.js:47:15)

[0mPOST /api/users/register [32m201[0m 236.459 ms - 914[0m
[0mPOST /api/users/login [32m200[0m 218.049 ms - 904[0m
  console.error
    Failed to create Stripe customer: Error: Stripe is not configured. Please set STRIPE_SECRET_KEY in environment variables.
        at ensureStripeCustomerForUser (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:28:11)
        at ensureStripeCustomerForUser (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/user.controller.js:45:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      45 |       await ensureStripeCustomerForUser(user._id);
      46 |     } catch (stripeError) {
    > 47 |       console.error("Failed to create Stripe customer:", stripeError);
         |               ^
      48 |       // Don't block signup if Stripe customer creation fails
      49 |     }
      50 |

      at error (src/controllers/user.controller.js:47:15)

[0mPOST /api/users/register [32m201[0m 217.995 ms - 921[0m
[0mPOST /api/users/login [32m200[0m 215.734 ms - 909[0m
[0mGET /api/admin/analytics/restaurants [33m401[0m 0.631 ms - 53[0m
[0mGET /api/admin/analytics/restaurants [33m403[0m 3.155 ms - 51[0m
[0mGET /api/admin/analytics/restaurants [32m200[0m 10.871 ms - 993[0m
[0mGET /api/admin/analytics/restaurants?timeRange=week [32m200[0m 3.323 ms - 531[0m
[0mGET /api/admin/analytics/platform [33m401[0m 0.386 ms - 53[0m
[0mGET /api/admin/analytics/platform [33m403[0m 1.671 ms - 51[0m
[0mGET /api/admin/analytics/platform [32m200[0m 3.143 ms - 273[0m
[0mGET /api/admin/analytics/platform?timeRange=month [32m200[0m 2.850 ms - 275[0m
[0mGET /api/admin/analytics/trends [33m401[0m 0.362 ms - 53[0m
[0mGET /api/admin/analytics/trends [33m403[0m 1.704 ms - 51[0m
[0mGET /api/admin/analytics/trends [32m200[0m 3.312 ms - 343[0m
[0mGET /api/admin/analytics/trends?timeRange=year&groupBy=month [32m200[0m 2.923 ms - 332[0m
[0mGET /api/admin/analytics/top-restaurants [33m401[0m 0.363 ms - 53[0m
[0mGET /api/admin/analytics/top-restaurants [33m403[0m 1.769 ms - 51[0m
[0mGET /api/admin/analytics/top-restaurants [32m200[0m 2.897 ms - 1012[0m
[0mGET /api/admin/analytics/top-restaurants?metric=orders&limit=5 [32m200[0m 3.028 ms - 1011[0m
[0mGET /api/admin/analytics/top-restaurants?limit=3 [32m200[0m 2.731 ms - 1012[0m
[0mGET /api/admin/analytics/dashboard [33m401[0m 0.352 ms - 53[0m
[0mGET /api/admin/analytics/dashboard [33m403[0m 1.542 ms - 51[0m
[0mGET /api/admin/analytics/dashboard [32m200[0m 5.629 ms - 3406[0m
[0mGET /api/admin/analytics/dashboard?timeRange=week [32m200[0m 5.706 ms - 1884[0m
[0mGET /api/admin/analytics/dashboard [32m200[0m 6.702 ms - 3406[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running tests against database: test

      at Object.log (src/__tests__/order.test.js:37:11)

  console.log
    [OrderController] lookup cart {
      userId: new ObjectId('69370426e778d3338dae71a0'),
      sessionId: 'tOKizIg283U1hABwzSvD1Zc3nXd3wPmw',
      cartId: undefined
    }

      at log (src/controllers/order.controller.js:29:13)

  console.log
    [OrderController] carts found {
      userCartId: new ObjectId('69370426e778d3338dae71ab'),
      userCartItems: 1,
      sessionCartId: undefined,
      sessionCartItems: undefined,
      sessionStoredCartId: undefined,
      sessionStoredCartItems: undefined
    }

      at log (src/controllers/order.controller.js:36:13)

  console.log
    [OrderController] selected cart {
      cartId: new ObjectId('69370426e778d3338dae71ab'),
      items: 1,
      sessionId: 'test-session',
      userId: new ObjectId('69370426e778d3338dae71a0')
    }

      at log (src/controllers/order.controller.js:59:15)

  console.log
    [OrderController] Cart items before populate: [{"foodItem":"69370426e778d3338dae71a9","foodItemType":"object","item":"Test Burger"}]

      at log (src/controllers/order.controller.js:73:13)

  console.log
    [OrderController] Cart items after populate: [{"foodItem":"69370426e778d3338dae71a9","foodItemType":"object","isNull":false,"item":"Test Burger"}]

      at log (src/controllers/order.controller.js:78:13)

[0mPOST /api/orders [32m201[0m 33.258 ms - 1257[0m
[0mPOST /api/orders [33m401[0m 0.483 ms - 53[0m
  console.log
    [OrderController] lookup cart {
      userId: new ObjectId('69370426e778d3338dae71a0'),
      sessionId: '27OPPZtK_1bPnvzMLZroVUXrPm5dISWn',
      cartId: undefined
    }

      at log (src/controllers/order.controller.js:29:13)

  console.log
    [OrderController] carts found {
      userCartId: new ObjectId('69370426e778d3338dae71ab'),
      userCartItems: 0,
      sessionCartId: undefined,
      sessionCartItems: undefined,
      sessionStoredCartId: undefined,
      sessionStoredCartItems: undefined
    }

      at log (src/controllers/order.controller.js:36:13)

  console.log
    [OrderController] selected cart {
      cartId: new ObjectId('69370426e778d3338dae71ab'),
      items: 0,
      sessionId: 'test-session',
      userId: new ObjectId('69370426e778d3338dae71a0')
    }

      at log (src/controllers/order.controller.js:59:15)

  console.warn
    [OrderController] cart missing or empty {
      userId: new ObjectId('69370426e778d3338dae71a0'),
      sessionId: '27OPPZtK_1bPnvzMLZroVUXrPm5dISWn',
      cartId: undefined
    }

      61 |
      62 |     if (!cart || !cart.items || cart.items.length === 0) {
    > 63 |       console.warn('[OrderController] cart missing or empty', { userId, sessionId, cartId });
         |               ^
      64 |       return res.status(400).json({
      65 |         success: false,
      66 |         message: 'Cart is empty'

      at warn (src/controllers/order.controller.js:63:15)

[0mPOST /api/orders [33m400[0m 4.829 ms - 43[0m
  console.log
    [OrderController] lookup cart {
      userId: new ObjectId('69370426e778d3338dae71a0'),
      sessionId: 'K2dSZSLM_-UKxyO1kYUwMOoGEjHlWRaZ',
      cartId: undefined
    }

      at log (src/controllers/order.controller.js:29:13)

  console.log
    [OrderController] carts found {
      userCartId: new ObjectId('69370426e778d3338dae71ab'),
      userCartItems: 1,
      sessionCartId: undefined,
      sessionCartItems: undefined,
      sessionStoredCartId: undefined,
      sessionStoredCartItems: undefined
    }

      at log (src/controllers/order.controller.js:36:13)

  console.log
    [OrderController] selected cart {
      cartId: new ObjectId('69370426e778d3338dae71ab'),
      items: 1,
      sessionId: 'test-session',
      userId: new ObjectId('69370426e778d3338dae71a0')
    }

      at log (src/controllers/order.controller.js:59:15)

  console.log
    [OrderController] Cart items before populate: [{"foodItem":"69370426e778d3338dae71a9","foodItemType":"object","item":"Test Burger"}]

      at log (src/controllers/order.controller.js:73:13)

  console.log
    [OrderController] Cart items after populate: [{"foodItem":"69370426e778d3338dae71a9","foodItemType":"object","isNull":false,"item":"Test Burger"}]

      at log (src/controllers/order.controller.js:78:13)

[0mPOST /api/orders [32m201[0m 16.618 ms - 1255[0m
  console.log
    [OrderController] lookup cart {
      userId: new ObjectId('69370426e778d3338dae71a0'),
      sessionId: 'RAK45GeW6PYmQCVv2Rrzyfo1FSFOncIk',
      cartId: undefined
    }

      at log (src/controllers/order.controller.js:29:13)

  console.log
    [OrderController] carts found {
      userCartId: new ObjectId('69370426e778d3338dae71ab'),
      userCartItems: 1,
      sessionCartId: undefined,
      sessionCartItems: undefined,
      sessionStoredCartId: undefined,
      sessionStoredCartItems: undefined
    }

      at log (src/controllers/order.controller.js:36:13)

  console.log
    [OrderController] selected cart {
      cartId: new ObjectId('69370426e778d3338dae71ab'),
      items: 1,
      sessionId: 'test-session',
      userId: new ObjectId('69370426e778d3338dae71a0')
    }

      at log (src/controllers/order.controller.js:59:15)

  console.log
    [OrderController] Cart items before populate: [{"foodItem":"69370426e778d3338dae71a9","foodItemType":"object","item":"Test Burger"}]

      at log (src/controllers/order.controller.js:73:13)

  console.log
    [OrderController] Cart items after populate: [{"foodItem":"69370426e778d3338dae71a9","foodItemType":"object","isNull":false,"item":"Test Burger"}]

      at log (src/controllers/order.controller.js:78:13)

[0mPOST /api/orders [32m201[0m 17.982 ms - 1255[0m
[0mGET /api/orders?page=1&limit=10 [32m200[0m 5.795 ms - 1123[0m
[0mGET /api/orders [33m401[0m 0.395 ms - 53[0m
[0mGET /api/orders?page=1&limit=2 [32m200[0m 5.506 ms - 2150[0m
[0mGET /api/orders/insights?timeRange=all [32m200[0m 9.415 ms - 742[0m
[0mGET /api/orders/insights [33m401[0m 0.462 ms - 53[0m
[0mGET /api/orders/69370426e778d3338dae71fc [32m200[0m 5.096 ms - 1067[0m
[0mGET /api/orders/69370426e778d3338dae7203 [33m404[0m 2.509 ms - 45[0m
[0mGET /api/orders/69370427e778d3338dae7209 [33m403[0m 2.724 ms - 77[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running tests against database: test

      at Object.log (src/__tests__/admin.test.js:35:11)

[0mGET /api/admin/analytics/dashboard?timeRange=all [32m200[0m 9.719 ms - 1809[0m
[0mGET /api/admin/analytics/dashboard [33m403[0m 1.842 ms - 51[0m
[0mGET /api/admin/analytics/dashboard [33m401[0m 0.458 ms - 53[0m
[0mGET /api/admin/analytics/restaurants?timeRange=all [32m200[0m 3.603 ms - 501[0m
[0mGET /api/admin/analytics/restaurants?timeRange=month [32m200[0m 3.175 ms - 503[0m
[0mGET /api/admin/analytics/platform?timeRange=all [32m200[0m 2.719 ms - 269[0m
[0mGET /api/admin/analytics/trends?timeRange=all&groupBy=day [32m200[0m 2.749 ms - 206[0m
[0mGET /api/admin/analytics/top-restaurants?metric=revenue&limit=10&timeRange=all [32m200[0m 2.940 ms - 520[0m
[0mGET /api/admin/analytics/top-restaurants?metric=orders&limit=10&timeRange=all [32m200[0m 2.812 ms - 519[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ”„ add secrets lifecycle management: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running tests against database: test

      at Object.log (src/__tests__/review.test.js:35:11)

[0mPOST /api/reviews [32m201[0m 22.129 ms - 413[0m
[0mPOST /api/reviews [33m400[0m 1.732 ms - 66[0m
[0mPOST /api/reviews [33m400[0m 1.576 ms - 66[0m
[0mPOST /api/reviews [33m404[0m 3.039 ms - 49[0m
[0mPOST /api/reviews [33m409[0m 4.114 ms - 65[0m
[0mPOST /api/reviews [33m401[0m 0.363 ms - 53[0m
[0mPOST /api/reviews [33m400[0m 1.543 ms - 71[0m
[0mGET /api/reviews/food/69370428f473f122989a7b8c [32m200[0m 7.256 ms - 871[0m
[0mGET /api/reviews/food/69370429f473f122989a7bb2 [32m200[0m 4.371 ms - 209[0m
[0mPATCH /api/reviews/69370429f473f122989a7bb9 [32m200[0m 7.184 ms - 413[0m
[0mPATCH /api/reviews/69370429f473f122989a7bc1 [33m403[0m 2.620 ms - 78[0m
[0mPATCH /api/reviews/69370429f473f122989a7bc6 [33m404[0m 2.370 ms - 46[0m
[0mDELETE /api/reviews/69370429f473f122989a7bca [32m200[0m 3.561 ms - 56[0m
[0mDELETE /api/reviews/69370429f473f122989a7bd1 [33m403[0m 2.486 ms - 78[0m
[0mPATCH /api/reviews/69370429f473f122989a7bd6/helpful [32m200[0m 7.885 ms - 454[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ“¡ add observability to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running payment tests against database: test

      at Object.log (src/__tests__/payment.controller.test.js:41:11)

[0mPOST /api/payments/create-intent [33m401[0m 1.461 ms - 53[0m
[0mPOST /api/payments/create-intent [33m400[0m 4.983 ms - 50[0m
  console.error
    Error creating payment intent: Error: Payment processing is not available. Stripe is not configured. Please set STRIPE_SECRET_KEY in environment variables.
        at Module.createPaymentIntent (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:90:13)
        at createPaymentIntent (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:28:41)
        at Layer.handleRequest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/router/lib/layer.js:152:17)
        at next (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/router/lib/route.js:157:13)
        at next (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/middleware/auth.middleware.js:66:5)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      163 |     };
      164 |   } catch (error) {
    > 165 |     console.error("Error creating payment intent:", error);
          |             ^
      166 |     throw error;
      167 |   }
      168 | };

      at Module.error (src/services/paymentService.js:165:13)
      at createPaymentIntent (src/controllers/payment.controller.js:28:41)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at next (src/middleware/auth.middleware.js:66:5)

  console.error
    Error in createPaymentIntent controller: Error: Payment processing is not available. Stripe is not configured. Please set STRIPE_SECRET_KEY in environment variables.
        at Module.createPaymentIntent (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:90:13)
        at createPaymentIntent (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:28:41)
        at Layer.handleRequest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/router/lib/layer.js:152:17)
        at next (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/router/lib/route.js:157:13)
        at next (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/middleware/auth.middleware.js:66:5)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      39 |     });
      40 |   } catch (error) {
    > 41 |     console.error("Error in createPaymentIntent controller:", error);
         |             ^
      42 |     res.status(500).json({
      43 |       success: false,
      44 |       message: error.message || "Failed to create payment intent",

      at error (src/controllers/payment.controller.js:41:13)

[0mPOST /api/payments/create-intent [31m500[0m 11.478 ms - 147[0m
[0mPOST /api/payments/confirm [33m401[0m 0.378 ms - 53[0m
[0mPOST /api/payments/confirm [33m400[0m 1.896 ms - 59[0m
[0mGET /api/payments/6937042a6a118df3b912f3d8 [33m401[0m 0.476 ms - 53[0m
[0mGET /api/payments/6937042a6a118df3b912f3d8 [33m403[0m 8.619 ms - 60[0m
[0mGET /api/payments/6937042a6a118df3b912f3e1 [33m404[0m 2.845 ms - 47[0m
[0mGET /api/payments/6937042a6a118df3b912f3d8 [33m403[0m 5.453 ms - 60[0m
  console.error
    Error fetching payment: CastError: Cast to ObjectId failed for value "invalid-id" (type string) at path "_id" for model "Payment"
        at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:251:11)
        at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
        at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
        at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
        at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
        at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
        at model.Query._findOne (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2697:8)
        at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Module.getPaymentById (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:250:21)
        at getPayment (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:94:21) {
      stringValue: '"invalid-id"',
      messageFormat: undefined,
      kind: 'ObjectId',
      value: 'invalid-id',
      path: '_id',
      reason: BSONError: input must be a 24 character hex string, 12 byte Uint8Array, or an integer
          at new ObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/bson/src/objectid.ts:120:15)
          at castObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast/objectid.js:25:12)
          at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:249:12)
          at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
          at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
          at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
          at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
          at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
          at model.Query._findOne (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2697:8)
          at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Module.getPaymentById (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:250:21)
          at getPayment (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:94:21),
      valueType: 'string'
    }

      253 |     return payment;
      254 |   } catch (error) {
    > 255 |     console.error("Error fetching payment:", error);
          |             ^
      256 |     throw error;
      257 |   }
      258 | };

      at Module.error (src/services/paymentService.js:255:13)
      at getPayment (src/controllers/payment.controller.js:94:21)

  console.error
    Error in getPayment controller: CastError: Cast to ObjectId failed for value "invalid-id" (type string) at path "_id" for model "Payment"
        at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:251:11)
        at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
        at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
        at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
        at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
        at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
        at model.Query._findOne (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2697:8)
        at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Module.getPaymentById (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:250:21)
        at getPayment (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:94:21) {
      stringValue: '"invalid-id"',
      messageFormat: undefined,
      kind: 'ObjectId',
      value: 'invalid-id',
      path: '_id',
      reason: BSONError: input must be a 24 character hex string, 12 byte Uint8Array, or an integer
          at new ObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/bson/src/objectid.ts:120:15)
          at castObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast/objectid.js:25:12)
          at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:249:12)
          at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
          at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
          at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
          at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
          at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
          at model.Query._findOne (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2697:8)
          at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Module.getPaymentById (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:250:21)
          at getPayment (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:94:21),
      valueType: 'string'
    }

      114 |     });
      115 |   } catch (error) {
    > 116 |     console.error("Error in getPayment controller:", error);
          |             ^
      117 |     res.status(500).json({
      118 |       success: false,
      119 |       message: "Failed to fetch payment",

      at error (src/controllers/payment.controller.js:116:13)

[0mGET /api/payments/invalid-id [31m500[0m 27.737 ms - 53[0m
[0mGET /api/payments [33m401[0m 0.422 ms - 53[0m
[0mGET /api/payments [32m200[0m 5.337 ms - 923[0m
[0mGET /api/payments?limit=5&skip=0 [32m200[0m 4.269 ms - 923[0m
[0mGET /api/payments?status=pending [32m200[0m 4.583 ms - 923[0m
[0mGET /api/payments [32m200[0m 3.940 ms - 923[0m
[0mGET /api/payments/methods [33m401[0m 0.392 ms - 53[0m
  console.error
    Error fetching payment: CastError: Cast to ObjectId failed for value "methods" (type string) at path "_id" for model "Payment"
        at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:251:11)
        at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
        at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
        at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
        at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
        at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
        at model.Query._findOne (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2697:8)
        at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Module.getPaymentById (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:250:21)
        at getPayment (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:94:21) {
      stringValue: '"methods"',
      messageFormat: undefined,
      kind: 'ObjectId',
      value: 'methods',
      path: '_id',
      reason: BSONError: input must be a 24 character hex string, 12 byte Uint8Array, or an integer
          at new ObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/bson/src/objectid.ts:120:15)
          at castObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast/objectid.js:25:12)
          at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:249:12)
          at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
          at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
          at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
          at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
          at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
          at model.Query._findOne (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2697:8)
          at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Module.getPaymentById (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:250:21)
          at getPayment (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:94:21),
      valueType: 'string'
    }

      253 |     return payment;
      254 |   } catch (error) {
    > 255 |     console.error("Error fetching payment:", error);
          |             ^
      256 |     throw error;
      257 |   }
      258 | };

      at Module.error (src/services/paymentService.js:255:13)
      at getPayment (src/controllers/payment.controller.js:94:21)

  console.error
    Error in getPayment controller: CastError: Cast to ObjectId failed for value "methods" (type string) at path "_id" for model "Payment"
        at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:251:11)
        at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
        at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
        at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
        at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
        at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
        at model.Query._findOne (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2697:8)
        at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Module.getPaymentById (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:250:21)
        at getPayment (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:94:21) {
      stringValue: '"methods"',
      messageFormat: undefined,
      kind: 'ObjectId',
      value: 'methods',
      path: '_id',
      reason: BSONError: input must be a 24 character hex string, 12 byte Uint8Array, or an integer
          at new ObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/bson/src/objectid.ts:120:15)
          at castObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast/objectid.js:25:12)
          at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:249:12)
          at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
          at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
          at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
          at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
          at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
          at model.Query._findOne (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2697:8)
          at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Module.getPaymentById (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:250:21)
          at getPayment (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:94:21),
      valueType: 'string'
    }

      114 |     });
      115 |   } catch (error) {
    > 116 |     console.error("Error in getPayment controller:", error);
          |             ^
      117 |     res.status(500).json({
      118 |       success: false,
      119 |       message: "Failed to fetch payment",

      at error (src/controllers/payment.controller.js:116:13)

[0mGET /api/payments/methods [31m500[0m 2.554 ms - 53[0m
[0mGET /api/payments/order/6937042a6a118df3b912f3d6 [33m401[0m 0.413 ms - 53[0m
[0mGET /api/payments/order/6937042a6a118df3b912f3d6 [33m403[0m 3.080 ms - 67[0m
[0mGET /api/payments/order/6937042a6a118df3b912f3d6 [33m403[0m 5.285 ms - 67[0m
[0mGET /api/payments/order/6937042a6a118df3b912f3fa [32m200[0m 3.071 ms - 40[0m
  console.error
    Error fetching payments by order: CastError: Cast to ObjectId failed for value "invalid-id" (type string) at path "orderId" for model "Payment"
        at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:251:11)
        at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
        at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
        at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
        at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
        at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
        at model.Query._find (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2401:8)
        at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Module.getPaymentsByOrderId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:267:22)
        at getOrderPayments (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:188:22) {
      stringValue: '"invalid-id"',
      messageFormat: undefined,
      kind: 'ObjectId',
      value: 'invalid-id',
      path: 'orderId',
      reason: BSONError: input must be a 24 character hex string, 12 byte Uint8Array, or an integer
          at new ObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/bson/src/objectid.ts:120:15)
          at castObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast/objectid.js:25:12)
          at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:249:12)
          at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
          at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
          at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
          at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
          at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
          at model.Query._find (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2401:8)
          at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Module.getPaymentsByOrderId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:267:22)
          at getOrderPayments (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:188:22),
      valueType: 'string'
    }

      268 |     return payments;
      269 |   } catch (error) {
    > 270 |     console.error("Error fetching payments by order:", error);
          |             ^
      271 |     throw error;
      272 |   }
      273 | };

      at Module.error (src/services/paymentService.js:270:13)
      at getOrderPayments (src/controllers/payment.controller.js:188:22)

  console.error
    Error in getOrderPayments controller: CastError: Cast to ObjectId failed for value "invalid-id" (type string) at path "orderId" for model "Payment"
        at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:251:11)
        at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
        at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
        at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
        at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
        at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
        at model.Query._find (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2401:8)
        at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Module.getPaymentsByOrderId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:267:22)
        at getOrderPayments (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:188:22) {
      stringValue: '"invalid-id"',
      messageFormat: undefined,
      kind: 'ObjectId',
      value: 'invalid-id',
      path: 'orderId',
      reason: BSONError: input must be a 24 character hex string, 12 byte Uint8Array, or an integer
          at new ObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/bson/src/objectid.ts:120:15)
          at castObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast/objectid.js:25:12)
          at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:249:12)
          at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
          at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
          at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
          at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
          at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
          at model.Query._find (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2401:8)
          at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Module.getPaymentsByOrderId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:267:22)
          at getOrderPayments (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/payment.controller.js:188:22),
      valueType: 'string'
    }

      202 |     });
      203 |   } catch (error) {
    > 204 |     console.error("Error in getOrderPayments controller:", error);
          |             ^
      205 |     res.status(500).json({
      206 |       success: false,
      207 |       message: "Failed to fetch order payments",

      at error (src/controllers/payment.controller.js:204:13)

[0mGET /api/payments/order/invalid-id [31m500[0m 2.858 ms - 60[0m
[0mGET /api/payments/order/6937042a6a118df3b912f400 [32m200[0m 3.143 ms - 40[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running tests against database: test

      at Object.log (src/__tests__/bug.test.js:33:11)

[0mPOST /api/bugs [32m201[0m 7.899 ms - 498[0m
[0mPOST /api/bugs [32m201[0m 3.909 ms - 451[0m
[0mPOST /api/bugs [33m400[0m 1.772 ms - 64[0m
[0mPOST /api/bugs [33m400[0m 1.606 ms - 64[0m
[0mPOST /api/bugs [33m400[0m 1.515 ms - 52[0m
[0mPOST /api/bugs [33m400[0m 1.410 ms - 58[0m
[0mGET /api/bugs [32m200[0m 10.436 ms - 619[0m
[0mGET /api/bugs [33m403[0m 1.784 ms - 51[0m
[0mGET /api/bugs [33m401[0m 0.413 ms - 53[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ” prevent committing .env to code: https://dotenvx.com/precommit

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running tests against database: test

      at Object.log (src/__tests__/adminAnalytics.test.js:34:11)

  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ”‘ add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

[0mGET / [32m200[0m 1.895 ms - 56[0m
[0mGET / [32m200[0m 0.436 ms - 56[0m
[0mGET / [32m200[0m 0.356 ms - 56[0m
[0mGET / [32m200[0m 0.399 ms - 56[0m
[0mGET / [32m200[0m 0.311 ms - 56[0m
[0mGET /non-existent-route [33m404[0m 0.328 ms - 32[0m
[0mGET /api/non-existent-endpoint [33m404[0m 0.392 ms - 32[0m
[0mPOST /api/fake-endpoint [33m404[0m 0.364 ms - 32[0m
[0mPUT /api/invalid-route [33m404[0m 0.330 ms - 32[0m
[0mDELETE /api/invalid-route [33m404[0m 0.392 ms - 32[0m
[0mPATCH /api/invalid-route [33m404[0m 0.284 ms - 32[0m
[0mGET /api/v1/nested/fake/route [33m404[0m 0.320 ms - 32[0m
[0mPOST /api/cart/items [33m400[0m 0.820 ms - 50[0m
  console.error
    SyntaxError: Expected property name or '}' in JSON at position 2 (line 1 column 3)
        at JSON.parse (<anonymous>)
        at parse (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/body-parser/lib/types/json.js:77:19)
        at /Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/body-parser/lib/read.js:123:18
        at AsyncResource.runInAsyncScope (node:async_hooks:214:14)
        at invokeCallback (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/raw-body/index.js:238:16)
        at done (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:508:28)
        at endReadableNT (node:internal/streams/readable:1701:12)
        at processTicksAndRejections (node:internal/process/task_queues:90:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{ invalid json }',
      type: 'entity.parse.failed'
    }

      78 | // Centralized error handler
      79 | app.use((err, req, res, next) => {
    > 80 |   console.error(err);
         |           ^
      81 |   res.status(err.status || 500).json({
      82 |     message: err.message || 'Internal server error',
      83 |   });

      at error (src/app.js:80:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/body-parser/lib/read.js:125:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

[0mPOST /api/cart/items [33m400[0m 0.330 ms - 54[0m
[0mPOST /api/cart/items [33m400[0m 0.309 ms - 54[0m
[0mPOST /api/cart/items [33m400[0m 0.303 ms - 50[0m
[0mGET /api/cart [32m200[0m 8.718 ms - 125[0m
[0mGET /api/cart [32m200[0m 4.963 ms - 125[0m
[0mGET /api/cart [32m200[0m 3.545 ms - 125[0m
[0mGET / [32m200[0m 0.358 ms - 56[0m
[0mGET /api/cart [32m200[0m 4.390 ms - 125[0m
[0mGET /api/cart [32m200[0m 3.012 ms - 125[0m
[0mPOST /api/cart/items [33m400[0m 0.323 ms - 50[0m
[0mPOST /api/cart/items [33m400[0m 0.318 ms - 50[0m
[0mPOST /api/cart/items [33m400[0m 0.330 ms - 50[0m
[0mGET / [32m200[0m 0.308 ms - 56[0m
[0mPOST /api/cart/items [33m400[0m 0.305 ms - 54[0m
[0mPATCH /api/cart/items/123 [33m404[0m 1.573 ms - 44[0m
[0mDELETE /api/cart/items/123 [33m404[0m 1.233 ms - 44[0m
[0mPUT /api/fake-endpoint [33m404[0m 0.301 ms - 32[0m
[0mGET / [32m200[0m 0.307 ms - 56[0m
[0mPOST /api/cart/items [33m400[0m 0.321 ms - 54[0m
[0mPOST /api/cart/items [33m400[0m 0.286 ms - 54[0m
[0mGET /api/cart [32m200[0m 4.207 ms - 125[0m
[0mPOST /api/cart/items [33m400[0m 0.319 ms - 50[0m
[0mGET / [32m200[0m 0.344 ms - 56[0m
[0mGET /non-existent [33m404[0m 0.293 ms - 32[0m
[0mGET /api/invalid-endpoint [33m404[0m 0.330 ms - 32[0m
[0mGET /invalid1 [33m404[0m 0.287 ms - 32[0m
[0mGET /invalid2 [33m404[0m 0.269 ms - 32[0m
[0mGET /invalid3 [33m404[0m 0.279 ms - 32[0m
[0mGET /api/cart [32m200[0m 4.228 ms - 125[0m
[0mGET /cart [33m404[0m 0.285 ms - 32[0m
[0mGET / [32m200[0m 0.298 ms - 56[0m
[0mGET / [32m200[0m 0.286 ms - 56[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ› ï¸  run anywhere with `dotenvx run -- yourcommand`

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running tests against database: test

      at Object.log (src/__tests__/orderAnalytics.test.js:32:11)

  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âœ… audit secrets and track compliance: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running combo tests against database: test

      at Object.log (src/__tests__/combo.controller.test.js:34:11)

[0mGET /api/food/combo-suggestions [33m400[0m 2.651 ms - 52[0m
[0mGET /api/food/combo-suggestions?mainItemId=6937042d72be8457e75ed6f1 [32m200[0m 11.798 ms - 1075[0m
[0mGET /api/food/combo-suggestions?mainItemId=6937042d72be8457e75ed6f1&limit=2 [32m200[0m 4.314 ms - 1075[0m
  console.error
    Error getting combo suggestions: CastError: Cast to ObjectId failed for value "invalid-id-123" (type string) at path "mainItemId" for model "MealCombination"
        at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:251:11)
        at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
        at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
        at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
        at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
        at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
        at model.Query._find (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2401:8)
        at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Object.getComboSuggestions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/comboService.js:16:18)
        at recommendCombos (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/combo.controller.js:34:25) {
      stringValue: '"invalid-id-123"',
      messageFormat: undefined,
      kind: 'ObjectId',
      value: 'invalid-id-123',
      path: 'mainItemId',
      reason: BSONError: input must be a 24 character hex string, 12 byte Uint8Array, or an integer
          at new ObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/bson/src/objectid.ts:120:15)
          at castObjectId (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast/objectid.js:25:12)
          at SchemaObjectId.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schema/objectId.js:249:12)
          at SchemaObjectId.SchemaType.applySetters (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1262:12)
          at SchemaObjectId.SchemaType.castForQuery (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/schemaType.js:1698:17)
          at cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/cast.js:390:32)
          at model.Query.Query.cast (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:5060:12)
          at model.Query.Query._castConditions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2374:10)
          at model.Query._find (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:2401:8)
          at model.Query.exec (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/mongoose/lib/query.js:4627:80)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Object.getComboSuggestions (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/comboService.js:16:18)
          at recommendCombos (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/controllers/combo.controller.js:34:25),
      valueType: 'string'
    }

      50 |     });
      51 |   } catch (error) {
    > 52 |     console.error("Error getting combo suggestions:", error);
         |             ^
      53 |     res.status(500).json({
      54 |       success: false,
      55 |       message: "Failed to get combo suggestions",

      at error (src/controllers/combo.controller.js:52:13)

[0mGET /api/food/combo-suggestions?mainItemId=invalid-id-123 [31m500[0m 25.910 ms - 61[0m
[0mGET /api/food/combo-suggestions?mainItemId=6937042d72be8457e75ed6f1 [32m200[0m 4.559 ms - 1075[0m
[0mGET /api/food/combo-suggestions?mainItemId=6937042d72be8457e75ed6f1&nutritional_focus=low_sugar [32m200[0m 4.002 ms - 1075[0m
[0mGET /api/food/combo-suggestions?mainItemId=6937042d72be8457e75ed6f1&nutritional_focus=low_sodium [32m200[0m 5.602 ms - 1075[0m
[0mGET /api/food/combo-suggestions?mainItemId=6937042d72be8457e75ed6f1&preferences=%7B%22lowSugar%22%3Atrue%2C%22lowSodium%22%3Afalse%7D [32m200[0m 3.842 ms - 1075[0m
[0mGET /api/food/combo-suggestions?mainItemId=6937042d72be8457e75ed6f1&preferences=invalid-json%7B [32m200[0m 3.649 ms - 1075[0m
[0mGET /api/food/combo-suggestions?mainItemId=6937042d72be8457e75ed712 [32m200[0m 2.292 ms - 43[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ” prevent building .env in docker: https://dotenvx.com/prebuild

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running ingredient recommendation tests against database: test

      at Object.log (src/__tests__/ingredientRecommendation.test.js:31:13)

[0mGET /api/recommendations/ingredients?include=chicken [32m200[0m 3.323 ms - 1644[0m
[0mGET /api/recommendations/ingredients?include=chicken%2Clettuce [32m200[0m 1.637 ms - 1148[0m
[0mGET /api/recommendations/ingredients?exclude=cheese [32m200[0m 1.878 ms - 4057[0m
[0mGET /api/recommendations/ingredients?include=chicken&exclude=cheese [32m200[0m 1.606 ms - 632[0m
[0mGET /api/recommendations/ingredients?include=chicken&page=1&limit=2 [32m200[0m 1.446 ms - 1137[0m
[0mGET /api/recommendations/ingredients?limit=200 [32m200[0m 1.472 ms - 6091[0m
[0mGET /api/recommendations/ingredients?include=chicken [32m200[0m 1.446 ms - 1644[0m
[0mGET /api/recommendations/ingredients?include=%20chicken%20%2C%20lettuce%20 [32m200[0m 1.449 ms - 1148[0m
[0mGET /api/recommendations/ingredients [32m200[0m 1.486 ms - 6090[0m
[0mGET /api/recommendations/ingredients?include=chicken%2Cchicken%2Clettuce [32m200[0m 1.379 ms - 1148[0m
[0mGET /api/recommendations/ingredients?include=chicken%2Clettuce [32m200[0m 1.352 ms - 1148[0m
[0mGET /api/recommendations/ingredients?include=chicken [32m200[0m 1.384 ms - 1644[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âš™ï¸  enable debug logging with { debug: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    Running tests against database: test

      at Object.log (src/__tests__/food.integration.test.js:94:13)

[0mPOST /api/food/recommend [32m200[0m 7.272 ms - 1178[0m
[0mPOST /api/food/recommend [33m400[0m 1.234 ms - 153[0m
[0mPOST /api/food/recommend [33m400[0m 0.425 ms - 153[0m
[0mPOST /api/food/recommend [33m400[0m 0.357 ms - 153[0m
[0mPOST /api/food/recommend [33m400[0m 0.362 ms - 153[0m
[0mPOST /api/food/recommend [33m400[0m 0.289 ms - 188[0m
[0mPOST /api/food/recommend [32m200[0m 1.644 ms - 188[0m
[0mPOST /api/food/recommend [32m200[0m 1.724 ms - 1166[0m
[0mPOST /api/food/recommend [32m200[0m 1.725 ms - 743[0m
[0mPOST /api/food/recommend [32m200[0m 1.560 ms - 1171[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

[0mPOST /api/food/recommend [33m400[0m 1.332 ms - 153[0m
[0mPOST /api/food/recommend [32m200[0m 6.141 ms - 3457[0m
[0mPOST /api/food/recommend [32m200[0m 2.109 ms - 3454[0m
[0mPOST /api/food/recommend [32m200[0m 1.627 ms - 3454[0m
[0mPOST /api/food/recommend [33m400[0m 0.339 ms - 153[0m
[0mPOST /api/food/recommend [32m200[0m 1.706 ms - 167[0m
[0mPOST /api/food/recommend [32m200[0m 1.407 ms - 586[0m
[0mPOST /api/food/recommend [32m200[0m 1.487 ms - 3454[0m
[0mPOST /api/food/recommend [32m200[0m 1.476 ms - 3457[0m
[0mPOST /api/food/recommend [32m200[0m 1.569 ms - 3454[0m
[0mPOST /api/food/recommend [32m200[0m 2.000 ms - 3464[0m
[0mPOST /api/food/recommend [32m200[0m 1.539 ms - 3454[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ”‘ add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

[0mGET /api/recommendations/ingredients?include=lettuce%2Ctomato&exclude=bacon [32m200[0m 4.336 ms - 1064[0m
[0mGET /api/recommendations/ingredients?limit=500 [32m200[0m 1.734 ms - 1985[0m
[0mGET /api/recommendations/ingredients?include=chicken&limit=1&page=1 [32m200[0m 1.649 ms - 581[0m
[0mGET /api/recommendations/ingredients?include=chicken&limit=1&page=2 [32m200[0m 1.512 ms - 590[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âš™ï¸  enable debug logging with { debug: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

[0mPOST /api/food/recommend [33m400[0m 1.368 ms - 153[0m
[0mPOST /api/food/recommend [32m200[0m 4.500 ms - 3461[0m
[0mPOST /api/food/recommend [33m400[0m 0.375 ms - 153[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ” prevent building .env in docker: https://dotenvx.com/prebuild

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âš™ï¸  suppress all logs with { quiet: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Using in-memory MongoDB for tests.

      at log (src/config/database.js:167:15)

  console.log
    MongoDB Connected: 127.0.0.1

      at log (src/config/database.js:172:13)

  console.log
    Seeding database with sample food items...

      at log (src/config/database.js:16:13)

  console.log
    âœ… Successfully seeded 8 food items

      at log (src/config/database.js:151:13)

  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âš™ï¸  suppress all logs with { quiet: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

[0mGET /api/health [32m200[0m 1.978 ms - 110[0m
[0mGET /api/unknown [33m404[0m 0.620 ms - 32[0m
  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ”‘ add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)

  console.warn
    Stripe is not configured. Returning empty payment methods.

      64 | export const getSavedPaymentMethodsForUser = async (userId) => {
      65 |   if (!stripe) {
    > 66 |     console.warn("Stripe is not configured. Returning empty payment methods.");
         |             ^
      67 |     return [];
      68 |   }
      69 |

      at warn (src/services/paymentService.js:66:13)
      at Object.getSavedPaymentMethodsForUser (src/__tests__/paymentService.test.js:18:27)

  console.error
    Error creating payment intent: Error: Payment processing is not available. Stripe is not configured. Please set STRIPE_SECRET_KEY in environment variables.
        at createPaymentIntent (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:90:13)
        at Object.createPaymentIntent (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/__tests__/paymentService.test.js:23:18)
        at Promise.finally.completed (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at _runTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-runner/build/index.js:275:16)
        at runTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-runner/build/index.js:343:7)

      163 |     };
      164 |   } catch (error) {
    > 165 |     console.error("Error creating payment intent:", error);
          |             ^
      166 |     throw error;
      167 |   }
      168 | };

      at error (src/services/paymentService.js:165:13)
      at Object.createPaymentIntent (src/__tests__/paymentService.test.js:23:18)

  console.error
    Error confirming payment: Error: Payment processing is not available. Stripe is not configured.
        at confirmPayment (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/services/paymentService.js:178:13)
        at Object.confirmPayment (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/__tests__/paymentService.test.js:27:18)
        at Promise.finally.completed (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at _runTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-runner/build/index.js:275:16)
        at runTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-runner/build/index.js:343:7)

      236 |     return payment;
      237 |   } catch (error) {
    > 238 |     console.error("Error confirming payment:", error);
          |             ^
      239 |     throw error;
      240 |   }
      241 | };

      at error (src/services/paymentService.js:238:13)
      at Object.confirmPayment (src/__tests__/paymentService.test.js:27:18)

  console.error
    Simple search error: Error: db fail
        at Object.<anonymous> (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/__tests__/simpleSearch.service.test.js:35:50)
        at Promise.finally.completed (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at _runTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-runner/build/index.js:275:16)
        at runTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-runner/build/index.js:343:7)

      58 |       return items;
      59 |     } catch (error) {
    > 60 |       console.error('Simple search error:', error);
         |               ^
      61 |       return [];
      62 |     }
      63 |   }

      at SimpleSearchService.error [as search] (src/services/simpleSearch.service.js:60:15)
      at Object.<anonymous> (src/__tests__/simpleSearch.service.test.js:38:21)

  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âš™ï¸  suppress all logs with { quiet: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.error
    Authentication error: Error: Database failure
        at model.User.findById (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/__tests__/auth.middleware.test.js:204:15)
        at findById (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/middleware/auth.middleware.js:32:29)
        at Object.authenticate (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/src/__tests__/auth.middleware.test.js:207:11)
        at Promise.finally.completed (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at _runTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at run (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-runner/build/index.js:275:16)
        at runTest (/Users/kavyae/Downloads/SE/final_project/SE_Project-3_Group4/Proj_3/Howl2Go_backend/node_modules/jest-runner/build/index.js:343:7)

      66 |     next();
      67 |   } catch (error) {
    > 68 |     console.error('Authentication error:', error);
         |             ^
      69 |     return res.status(500).json({
      70 |       success: false,
      71 |       message: 'Authentication failed',

      at error (src/middleware/auth.middleware.js:68:13)
      at Object.authenticate (src/__tests__/auth.middleware.test.js:207:11)

  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âš™ï¸  write to custom object with { processEnv: myObject }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:16:28)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:16:28)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:16:28)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:31:28)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:31:28)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:31:28)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  write to custom object with { processEnv: myObject }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:50:28)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:50:28)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:50:28)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  suppress all logs with { quiet: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.warn
    âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.

       7 | // Initialize Stripe with API key - validate it's set
       8 | if (!env.stripe.secretKey) {
    >  9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
         |           ^
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }

      at warn (src/services/paymentService.js:9:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:78:28)

  console.warn
       Please set STRIPE_SECRET_KEY in your .env file

       8 | if (!env.stripe.secretKey) {
       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
    > 10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
         |           ^
      11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
      12 | }
      13 |

      at warn (src/services/paymentService.js:10:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:78:28)

  console.warn
       Get your keys from: https://dashboard.stripe.com/apikeys

       9 |   console.warn("âš ï¸  WARNING: STRIPE_SECRET_KEY is not set. Payment functionality will not work.");
      10 |   console.warn("   Please set STRIPE_SECRET_KEY in your .env file");
    > 11 |   console.warn("   Get your keys from: https://dashboard.stripe.com/apikeys");
         |           ^
      12 | }
      13 |
      14 | const stripe = env.stripe.secretKey 

      at warn (src/services/paymentService.js:11:11)
      at Object.<anonymous> (src/__tests__/paymentService.data.test.js:78:28)

  console.log
    Unhandled event type: unknown.event

      at Module.log (src/services/paymentService.js:379:17)

  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ‘¥ sync secrets across teammates & machines: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: ðŸ”‘ add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (4) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    â†’ Creating new Stripe customer for user user@test.com

      at log (src/services/paymentService.js:42:11)

  console.log
    âœ“ Created Stripe customer cus_123 for user user@test.com

      at log (src/services/paymentService.js:49:11)

  console.log
    â†’ Creating PaymentIntent for order order1 with customer cus_123

      at Module.log (src/services/paymentService.js:124:13)

  console.log
    âœ“ Created PaymentIntent pi_123 for customer cus_123

      at Module.log (src/services/paymentService.js:145:13)

-----------------------------------------|---------|----------|---------|---------|------------------------------------------------------------------------------------------------------------
File                                     | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                                                                                          
-----------------------------------------|---------|----------|---------|---------|------------------------------------------------------------------------------------------------------------
All files                                |   77.92 |    66.03 |   86.22 |   78.68 |                                                                                                            
 src                                     |   94.73 |       50 |     100 |   94.73 |                                                                                                            
  app.js                                 |   94.73 |       50 |     100 |   94.73 | 45                                                                                                         
 src/config                              |   80.55 |    55.55 |     100 |   80.55 |                                                                                                            
  database.js                            |   76.66 |    33.33 |     100 |   76.66 | 12-13,153,181-186                                                                                          
  env.js                                 |     100 |    73.33 |     100 |     100 | 5-14                                                                                                       
 src/controllers                         |   71.98 |    61.36 |   82.66 |   72.49 |                                                                                                            
  admin.controller.js                    |   77.77 |    73.68 |     100 |   77.77 | 33-34,67-68,102-103,137-138,183-184                                                                        
  bug.controller.js                      |   80.95 |       75 |     100 |   87.17 | 78-79,95,140-141                                                                                           
  cart.controller.js                     |   75.29 |     58.9 |   88.88 |   74.07 | 20,94-95,227-228,241-319,392-393,456-457,475,497-498,513,589-590                                           
  combo.controller.js                    |     100 |     87.5 |     100 |     100 | 45,48-56                                                                                                   
  food.controller.js                     |   70.73 |    62.06 |   66.66 |   75.67 | 14-15,46,48,54,87,89,101-102                                                                               
  health.controller.js                   |     100 |      100 |     100 |     100 |                                                                                                            
  ingredientRecommendation.controller.js |      68 |    64.28 |   71.42 |   71.42 | 23-27,48-49                                                                                                
  order.controller.js                    |   71.85 |    57.41 |      90 |   71.53 | 18,48,52,87,96-107,116,130,163,169-170,198-199,250-251,266,277,291-301,329-330,345,356,392-393,408,435-436 
  payment.controller.js                  |   52.94 |    57.14 |   55.55 |   53.57 | 30,64-78,111,146-147,159-175,217-247,259-277                                                               
  review.controller.js                   |   63.33 |    50.98 |      75 |   64.58 | 13,33-44,73,79-80,96,109-121,140-148,201-202,215-251,266,287,313-314,329,340,360-361,376,387,413-414       
  user.controller.js                     |   86.36 |    68.62 |     100 |   86.04 | 87,126-129,176-177,195,218-219,247,289,344-345                                                             
 src/middleware                          |   89.88 |    84.28 |     100 |   89.77 |                                                                                                            
  auth.middleware.js                     |     100 |    86.95 |     100 |     100 | 27,72,117                                                                                                  
  llm.middleware.js                      |   82.69 |    82.97 |     100 |   82.35 | 36-39,57-58,84,93-94                                                                                       
 src/models                              |   88.16 |    78.48 |   86.04 |   87.65 |                                                                                                            
  Bug.js                                 |     100 |      100 |     100 |     100 |                                                                                                            
  Cart.js                                |   96.49 |    69.76 |     100 |   96.15 | 83,171                                                                                                     
  FastFoodItem.js                        |     100 |      100 |     100 |     100 |                                                                                                            
  MealCombination.js                     |     100 |      100 |     100 |     100 |                                                                                                            
  Order.js                               |    92.1 |    95.45 |     100 |   91.89 | 163-165                                                                                                    
  Payment.js                             |      70 |      100 |       0 |      70 | 85,90,95                                                                                                   
  Review.js                              |    61.9 |       25 |   33.33 |    61.9 | 67,77,81-87                                                                                                
  User.js                                |   84.61 |      100 |      80 |      84 | 90-92,118                                                                                                  
 src/routes                              |     100 |      100 |     100 |     100 |                                                                                                            
  admin.routes.js                        |     100 |      100 |     100 |     100 |                                                                                                            
  bug.routes.js                          |     100 |      100 |     100 |     100 |                                                                                                            
  cart.routes.js                         |     100 |      100 |     100 |     100 |                                                                                                            
  combo.routes.js                        |     100 |      100 |     100 |     100 |                                                                                                            
  food.routes.js                         |     100 |      100 |     100 |     100 |                                                                                                            
  health.routes.js                       |     100 |      100 |     100 |     100 |                                                                                                            
  index.js                               |     100 |      100 |     100 |     100 |                                                                                                            
  order.routes.js                        |     100 |      100 |     100 |     100 |                                                                                                            
  payment.routes.js                      |     100 |      100 |     100 |     100 |                                                                                                            
  recommendations.routes.js              |     100 |      100 |     100 |     100 |                                                                                                            
  review.routes.js                       |     100 |      100 |     100 |     100 |                                                                                                            
  user.routes.js                         |     100 |      100 |     100 |     100 |                                                                                                            
 src/services                            |   76.55 |    67.67 |   85.71 |   77.92 |                                                                                                            
  adminAnalytics.js                      |   68.49 |    54.54 |   66.66 |   71.64 | 11-13,103-107,127,213-214,225,272-281                                                                      
  comboService.js                        |   73.68 |    57.89 |      75 |      75 | 53-60,73-74                                                                                                
  ingredientRecommendation.service.js    |      96 |    69.23 |     100 |      95 | 13-14                                                                                                      
  llm.service.js                         |   90.12 |    89.83 |     100 |   93.33 | 65-66,203,215-216                                                                                          
  orderAnalytics.js                      |    75.2 |    75.53 |      80 |   77.77 | 120-122,128-130,157-160,194-215,242,280-282,294,321                                                        
  paymentService.js                      |   68.65 |    53.57 |   93.75 |   69.54 | 35-38,70-78,97,105,115,188,215-216,222,298-299,310-348,382-383,449-450,459-460,469-516                     
  simpleSearch.service.js                |   94.44 |    77.77 |     100 |   94.44 | 41                                                                                                         
 src/utils                               |   92.98 |    78.33 |     100 |   96.22 |                                                                                                            
  jwt.util.js                            |   92.59 |    91.66 |     100 |    92.3 | 76,90                                                                                                      
  nutritionUtils.js                      |   93.33 |       75 |     100 |     100 | 13-16,20,30-45,53-58,71,80                                                                                 
-----------------------------------------|---------|----------|---------|---------|------------------------------------------------------------------------------------------------------------
Global test teardown complete
